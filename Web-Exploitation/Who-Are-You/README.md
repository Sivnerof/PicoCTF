# Who Are You

## Description

Let me in. Let me iiiiiiinnnnnnnnnnnnnnnnnnnn http://mercury.picoctf.net:36622/

## Hints

It ain't much, but it's an RFC https://tools.ietf.org/html/rfc2616

## Walkthrough

The homepage for this CTF tells us that only people who use the official "Pico Browser" can use the website.

> Only people who use the official PicoBrowser are allowed on this site!

We can spoof our browser by modifying the [User-Agent header](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/User-Agent "Mozilla developer pages on User-Agent header"), which is the HTTP header sent by our browser when making requests to servers. This header can be changed by using a browser extension such as [User-Agent Switcher and Manager](https://addons.mozilla.org/en-US/firefox/addon/user-agent-string-switcher/ "Firefox extension for modifying User-Agent header"), but we're better off using an application like BurpSuite for this challenge.

After we intercept a request to the homepage of the CTF we can edit the User-Agent header from our browser to "PicoBrowser", like so:

```http
GET / HTTP/1.1
Host: mercury.picoctf.net:36622
User-Agent: PicoBrowser
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Connection: keep-alive
Upgrade-Insecure-Requests: 1
DNT: 1
Sec-GPC: 1
Priority: u=0, i
```

Once we send the request, the homepage message will change to:

> I don&#39;t trust users visiting from another site.

We can add the ["Referer" header](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Referer "Mozilla Developer pages on Referer header") to our next request to trick the server into thinking the request originated from the webpage itself. To do this, we'll set the "Referer" header value to "mercury.picoctf.net:36622".

```http
GET / HTTP/1.1
Host: mercury.picoctf.net:36622
User-Agent: PicoBrowser
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Connection: keep-alive
Upgrade-Insecure-Requests: 1
DNT: 1
Sec-GPC: 1
Referer: mercury.picoctf.net:36622
Priority: u=0, i
```

```
Sorry, this site only worked in 2018.
```

```http
GET / HTTP/1.1
Host: mercury.picoctf.net:36622
User-Agent: PicoBrowser
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Connection: keep-alive
Upgrade-Insecure-Requests: 1
DNT: 1
Sec-GPC: 1
Referer: mercury.picoctf.net:36622
Date: Tue, 15 Oct 2018 14:30:00 GMT
Priority: u=0, i
```

```
This website is only for people from Sweden.
```
