# Dont Use Client Side

## Description

Can you break into this super secure portal? https://jupiter.challenges.picoctf.org/problem/37821/ ([link](https://jupiter.challenges.picoctf.org/problem/37821/ "Pico CTF link to insecure login portal")) or http://jupiter.challenges.picoctf.org:37821

## Hints

* Never trust the client

## Walktrhough

If we visit the [website for this challenge](https://jupiter.challenges.picoctf.org/problem/37821/ "Pico CTF link for challenge website") we'll see a login portal. Viewing the HTML source code we'll see that this login form uses client-side authentication via a JavaScript function named ```verify```.

```html
<html>
<head>
<title>Secure Login Portal</title>
</head>
<body bgcolor=blue>
<!-- standard MD5 implementation -->
<script type="text/javascript" src="md5.js"></script>

<script type="text/javascript">
  function verify() {
    checkpass = document.getElementById("pass").value;
    split = 4;
    if (checkpass.substring(0, split) == 'pico') {
      if (checkpass.substring(split*6, split*7) == 'a3c8') {
        if (checkpass.substring(split, split*2) == 'CTF{') {
         if (checkpass.substring(split*4, split*5) == 'ts_p') {
          if (checkpass.substring(split*3, split*4) == 'lien') {
            if (checkpass.substring(split*5, split*6) == 'lz_1') {
              if (checkpass.substring(split*2, split*3) == 'no_c') {
                if (checkpass.substring(split*7, split*8) == '9}') {
                  alert("Password Verified")
                  }
                }
              }
      
            }
          }
        }
      }
    }
    else {
      alert("Incorrect password");
    }
    
  }
</script>
<div style="position:relative; padding:5px;top:50px; left:38%; width:350px; height:140px; background-color:yellow">
<div style="text-align:center">
<p>This is the secure login portal</p>
<p>Enter valid credentials to proceed</p>
<form action="index.html" method="post">
<input type="password" id="pass" size="8" />
<br/>
<input type="submit" value="verify" onclick="verify(); return false;" />
</form>
</div>
</div>
</body>
</html>
```

If we take a closer look at the ```verify``` function, we'll see the strange way that this function verifies the users password. The function uses a series of nested if statements to continuosly check if specific segments of the user provided password match the same parts of the actual password. The only obfuscation done by the function is to do this all in segments and out of order.

```js
function verify() {
    checkpass = document.getElementById("pass").value;
    split = 4;
    if (checkpass.substring(0, split) == 'pico') {
        if (checkpass.substring(split * 6, split * 7) == 'a3c8') {
            if (checkpass.substring(split, split * 2) == 'CTF{') {
                if (checkpass.substring(split * 4, split * 5) == 'ts_p') {
                    if (checkpass.substring(split * 3, split * 4) == 'lien') {
                        if (checkpass.substring(split * 5, split * 6) == 'lz_1') {
                            if (checkpass.substring(split * 2, split * 3) == 'no_c') {
                                if (checkpass.substring(split * 7, split * 8) == '9}') {
                                    alert("Password Verified")
                                }
                            }
                        }
                    }
                }
            }
        }
    } else {
        alert("Incorrect password");
    }
}
```

We can rearrange the conditional statements and place them in the correct order to make viewing the actual password a lot easier.

```js
checkpass.substring(0, split) == 'pico'
checkpass.substring(split, split * 2) == 'CTF{'
checkpass.substring(split * 2, split * 3) == 'no_c'
checkpass.substring(split * 3, split * 4) == 'lien'
checkpass.substring(split * 4, split * 5) == 'ts_p'
checkpass.substring(split * 5, split * 6) == 'lz_1'
checkpass.substring(split * 6, split * 7) == 'a3c8'
checkpass.substring(split * 7, split * 8) == '9}'
```

Taking the 4 character long string pieces and placing them all together in the right order will reveal the password and flag needed to complete this challenge.

```picoCTF{no_clients_plz_1a3c89}```
