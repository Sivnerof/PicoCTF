# Login

## Description

My dog-sitter's brother made this website but I can't get in; can you help? [login.mars.picoctf.net](https://login.mars.picoctf.net/ "Pico CTF challenge webpage")

## Hints

* (None)

## Walkthrough

If we visit the [webpage for the CTF](https://login.mars.picoctf.net/ "CTF Challenge Website") we'll find a login form and if we view the source code for this webpage we'll also see that the HTML references a script named "index.js". 

```html
<!doctype html>
<html>
    <head>
        <link rel="stylesheet" href="styles.css">
        <script src="index.js"></script>
    </head>
    <body>
        <div>
          <h1>Login</h1>
          <form method="POST">
            <label for="username">Username</label>
            <input name="username" type="text"/>
            <label for="username">Password</label>
            <input name="password" type="password"/>
            <input type="submit" value="Submit"/>
          </form>
        </div>
    </body>
</html>
```

Looking at the contents of [index.js](https://login.mars.picoctf.net/index.js "JavaScript file for CTF challenge") we'll see the following JavaScript:

```javascript
(async()=>{await new Promise((e=>window.addEventListener("load",e))),document.querySelector("form").addEventListener("submit",(e=>{e.preventDefault();const r={u:"input[name=username]",p:"input[name=password]"},t={};for(const e in r)t[e]=btoa(document.querySelector(r[e]).value).replace(/=/g,"");return"YWRtaW4"!==t.u?alert("Incorrect Username"):"cGljb0NURns1M3J2M3JfNTNydjNyXzUzcnYzcl81M3J2M3JfNTNydjNyfQ"!==t.p?alert("Incorrect Password"):void alert(`Correct Password! Your flag is ${atob(t.p)}.`)}))})();
```

We can [pretty print](https://en.wikipedia.org/wiki/Prettyprint "Wikipedia page for pretty printing") the JavaScript code, this will make it easier for us to understand what the code does. 

```javascript
(async () => {
	await new Promise(e => window.addEventListener('load', e)), document.querySelector('form').addEventListener('submit', e => {
		e.preventDefault();
		const r = {
				u: 'input[name=username]',
				p: 'input[name=password]'
			}, t = {};
		for (const e in r)
			t[e] = btoa(document.querySelector(r[e]).value).replace(/=/g, '');
		return 'YWRtaW4' !== t.u ? alert('Incorrect Username') : 'cGljb0NURns1M3J2M3JfNTNydjNyXzUzcnYzcl81M3J2M3JfNTNydjNyfQ' !== t.p ? alert('Incorrect Password') : void alert(`Correct Password! Your flag is ${ atob(t.p) }.`);
	});
})();
```

The code above takes the username and password from the login form and checks it against two different base-64 encoded values.

```javascript
'YWRtaW4' !== t.u // Checks if Base-64 encoded value is equal to login form username

'cGljb0NURns1M3J2M3JfNTNydjNyXzUzcnYzcl81M3J2M3JfNTNydjNyfQ' !== t.p // Checks if Base-64 encoded value is equal to login form password
```

Decoding the two strings from Base-64 we'll get the following:

* ```YWRtaW4```: ```admin```

* ```cGljb0NURns1M3J2M3JfNTNydjNyXzUzcnYzcl81M3J2M3JfNTNydjNyfQ```: ```picoCTF{53rv3r_53rv3r_53rv3r_53rv3r_53rv3r}```

Now that we have the login username and password, you'll notice that the password is the flag itself.

* Username: ```admin```

* Password (and flag): ```picoCTF{53rv3r_53rv3r_53rv3r_53rv3r_53rv3r}```

If we login with the credentials listed above, a JavaScript alert will popup, this popup gives us the already known flag.

> Correct Password! Your flag is picoCTF{53rv3r_53rv3r_53rv3r_53rv3r_53rv3r}.

```picoCTF{53rv3r_53rv3r_53rv3r_53rv3r_53rv3r}```
