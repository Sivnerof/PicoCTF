# Cookies

## Description

Who doesn't love cookies? Try to figure out the best one. http://mercury.picoctf.net:54219/

## Hints

* None

## Walkthrough

A first glance at the website shows an input where you can type the name of a type of cookie.

![Cookie Home Page](./cookies-home-page.png "Cookie Home Page")

If we try the webpage out by providing the suggested text Snickerdoodle we'll see the text "I love snickerdoodle cookies!"

![Cookie 0 for Snickerdoodle](./cookie-0-snickerdoodle-2.png "Cookie 0 for Snickerdoodle")

We'll also see a cookie has been created with a name of "name" and a value of 0.

![Cookie 0 for Snickerdoodle](./cookie-0-snickerdoodle-1.png "Cookie 0 for Snickerdoodle")

Next, we can try changing the cookie value to 1, just to see what happens. If we do this, we'll see the webpage returns the text for Chocolate Chip.

![Cookie 1 for Chocolate Chip](./cookie-1-chocolate-chip-1.png "Cookie 1 for Chocolate Chip")

![Cookie 1 for Chocolate Chip](./cookie-1-chocolate-chip-2.png "Cookie 1 for Chocolate Chip")

It appears that incrementing the cookie value will show us every type of cookie and possibly even the flag.

We can look for the highest cookie value by selecting a random high number and seeing what it returns. The cookie value 30 for example returns an error and rewrites our cookie, giving it a value of -1.

![Cookie negative 1 for error](./cookie-negative-1-error-1.png "Cookie negative 1 for error")

![Cookie negative 1 for error](./cookie-negative-1-error-2.png "Cookie negative 1 for error")

Checking the webpage with a cookie value of 29 does the same, but 28 returns Macademia.

![Cookie 28 for Macademia](./cookie-28-macademia-1.png "Cookie 28 for Macademia")

![Cookie 28 for Macademia](./cookie-28-macademia-2.png "Cookie 28 for Macademia")

This suggests that our flag can be found within the cookie values of 0-28. After bruteforcing all possible cookie values between this range we'll find that the cookie with a value of 18 returns our flag.

![Cookie 18 for flag](./cookie-18-flag-1.png "Cookie 18 for flag")

![Cookie 18 for flag](./cookie-18-flag-2.png "Cookie 18 for flag")

Flag: ```picoCTF{3v3ry1_l0v3s_c00k135_96cdadfd}```
